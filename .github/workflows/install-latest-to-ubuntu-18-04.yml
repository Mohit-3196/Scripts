name:  Install Latest to Ubuntu 18.04
on: [push]
jobs:
  Install-Ubuntu-18-04:
    runs-on: ubuntu-18.04
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - run: echo "ðŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
      #Get latest version
      - run: wget -O ant-media-server-community.zip "https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&g=io.antmedia&a=ant-media-server&v=LATEST&c=community&e=zip";
      - run: ./install_ant-media-server.sh -i ant-media-server-community.zip
      - run: sudo service antmedia status 
      - run: cat /usr/local/antmedia/log/antmedia-error.log
      - run: |
          max_wait_time=20
          counter=0
          while [ $counter -lt $max_wait_time ]; do
            if [ -f "/usr/local/antmedia/log/ant-media-server.log" ]; then
              break
            fi
            sleep 1
            ((counter++))
          done
          
          if [ $counter -eq $max_wait_time ]; then
            echo "The log file did not appear within $max_wait_time seconds."
            exit 1
          else
            echo "The log file appeared after $counter seconds."
          fi
